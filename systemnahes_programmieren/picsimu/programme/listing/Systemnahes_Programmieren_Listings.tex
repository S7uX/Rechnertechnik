%Document
\documentclass[10pt,a4paper]{article} 
\begin{filecontents*}[overwrite]{\jobname.xmpdata}
    \Title{Systemnahes Programmieren Listings}
    \Author{Valerio Cocco}
    \Language{de}
\end{filecontents*}
\usepackage[a-3b]{pdfx}
\usepackage[left=1cm,right=1cm,top=1cm,bottom=2cm]{geometry} 
%Default packages
\usepackage[ngerman]{babel} 
\usepackage{fontspec}
\usepackage{fancyhdr}
\usepackage{lastpage}
\usepackage{xcolor}
\usepackage[most, minted]{tcolorbox}
% \usepackage[most, listings]{tcolorbox}
\usepackage{microtype}

%Meta
\usepackage{hyperref}
\hypersetup{
	hidelinks
}

\setmonofont{JetBrainsMono}[
  Path = ./JetBrainsMono/,
  Extension = .otf,
  % 
  UprightFont = *-Light,
  BoldFont = *-Bold,
  ItalicFont = *-LightItalic,
  BoldItalicFont = *-BoldItalic,
]


% Header Footer
\pagestyle{fancy}
\fancyhf{}
\renewcommand{\headrulewidth}{0pt} % no head rule

\rfoot{Seite \thepage \hspace{1pt} von \pageref{LastPage}}

\definecolor{LightGray}{HTML}{f7f7f7}

\newtcbinputlisting{assembler}[1]{%
    listing engine=minted,
    % listing engine=listings,
    minted language=gas,
    listing only,
    breakable,
    enhanced,
    minted options = {
        linenos, 
        breaklines=true, 
        breakbefore=., 
        fontsize=\footnotesize, 
        numbersep=2mm,
		baselinestretch=1.2
    },
    % listing options={
    %     language=Assembler,
    %     basicstyle=\ttfamily\footnotesize,
    %     numbers=left,
    %     breaklines=true,
    %     numberstyle=\tiny\ttfamily,
    %     xleftmargin=0mm,
    %     numbersep=2.5mm,
    % },
    overlay={%
        \begin{tcbclipinterior}
            \fill[gray!30] (frame.south west) rectangle ([xshift=4mm]frame.north west);
        \end{tcbclipinterior}
    },
	colframe=black,
	boxrule=0.8pt,
	colback=gray!10,
	sharp corners,
    top=0pt,
    bottom=0pt,
	listing file =#1
}

\renewcommand\theFancyVerbLine{\tiny\arabic{FancyVerbLine}} % minted

\begin{document} 
	\assembler{../binaerzaehler_aufg_1/binaerzaehler.src}
\end{document}

